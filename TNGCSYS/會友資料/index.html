<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>台北新恩堂</title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
<form action="#" method="post" name="formdata">
<div class="container">
  <a href="https://tngc-80913540.github.io/tngc.github.io/TNGCSYS/首頁/index.html" class="link-secondary" target="_blank" title="回首頁">回首頁</a>
<h1>會友資料表</h1>
<div style="text-align:right;">
<input type="text" id="time" name="時間" value="" style="width:16rem;"/>
			<script>
			  function t(){
			  var now= new Date();
			  var y=now.getFullYear();//年
			  var m=now.getMonth()+1;//月
			  var d=now.getDate();//日
			  var w=now.getDay();   //星期幾  返回0-6   (0=星期天) 
			  var ww = ' 星期'+'日一二三四五六'.charAt(new Date().getDay()) ;//星期幾
			  var h=now.getHours();
			  var M=now.getMinutes();
			  var S=now.getSeconds(); 
			  if (h>=0 && h <=12)
			  var ho=" AM";
			  if (h>12 && h<24)
			  var ho=" PM";
			  if(M<10){
			  M = "0"+M;
			  }
			  if(S<10){
			  S = "0"+S;
			  }
			  if(m<10){
			  m = "0"+m;
			  }
			  if(d<10){
			  d = "0"+d;
			  }
			  var tt=y+"-"+m+"-"+d+ww+"  "+h+":"+M+":"+S+ho;
			  document.getElementById("time").value=tt;
			  }
			  setInterval('t()',1);
			</script>
</div> 

<div class="row">
    <div class="col">
    <!-- <label for="fname">姓名</label> -->
    <input type="text" id="fname" name="姓名" placeholder="姓名..">  
    </div>
    <div class="col">
    <!-- <label for="lname">會友編號</label> -->
    <input type="text" id="會友編號" name="會友編號" placeholder="會友編號..">
    </div>
    <div class="col">
    <!-- <label for="lname">小組</label> -->
    <input type="text" id="小組" name="小組" placeholder="小組..">
    </div>
    <div class="col">
    <!-- <label for="lname">事工</label> -->
    <input type="text" id="事工" name="事工" placeholder="事工..">
    </div>
</div>
<div class="row">
    <div class="col">
    <!-- <label for="lname">生日</label> -->
    <input type="date" min="1900-01-01" max="2021-01-01" required="required" id="生日" name="生日" placeholder="生日..">
    </div>
    <div class="col">
    <!-- <label for="lname">身分證字號</label> -->
    <input type="text" id="lname" name="身分證字號" placeholder="身分證字號..">
    </div>
    <div class="col">
    <!-- <label for="lname">行動電話</label> -->
    <input type="text" required="required" maxlength="11" pattern="09\d{2}-\d{6}" id="行動電話" name="行動電話" placeholder="行動電話..">
    </div>
</div>
<div class="row">
    <div class="col">
    <!-- <label for="lname">住址</label> -->
    <input type="text" id="住址" name="住址" placeholder="住址..">
    </div>
    <div div class="col">
    <!-- <label for="lname">E-mail</label> -->
    <input type="email" required="required" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$" id="E-mail" name="E-mail" placeholder="E-mail..">
    </div>
</div>
<div class="row">
    <div class="col">
    <!-- <label for="lname">職業別</label> -->
    <input type="text" id="職業別" name="職業別" placeholder="職業別..">
    </div>
    <div class="col">
    <!-- <label for="lname">最高學歷</label> -->
    <input list="最高學歷" name="最高學歷" placeholder="最高學歷.."/>
    <datalist id="最高學歷">
      <option value="博士">博士</option> 
      <option value="碩士">碩士</option>
      <option value="大學">大學</option> 
      <option value="高中">高中</option>
      <option value="國中">國中</option>
      <option value="國小以下">國小以下</option>
      <option value="其他學歷">其他學歷</option>
    </select>
    </div>
    <div class="col">
    <!-- <label for="lname">畢業學校</label> -->
    <input type="text" id="畢業學校" name="畢業學校" placeholder="畢業學校..">
    </div>
    <div class="col">
        <!-- <label for="lname">畢業科系</label> -->
        <input type="text" id="畢業科系" name="畢業科系" placeholder="畢業科系..">
        </div>
</div>

<div class="row">
    <div class="col">
    <!-- <label for="lname">公司/學校名稱</label> -->
    <input type="text" id="公司/學校名稱" name="公司/學校名稱" placeholder="公司/學校名稱..">
    </div>
    <div class="col">
    <!-- <label for="lname">公司職稱/年級</label> -->
    <input type="text" id="公司職稱/年級" name="公司職稱/年級" placeholder="公司職稱/年級..">
    </div>
</div>
<div class="row">
    <div class="col">
    <!-- <label for="lname">受洗教會及牧師</label> -->
    <input type="text" id="受洗教會及牧師" name="受洗教會及牧師" placeholder="受洗教會及牧師..">
    </div>
    <div class="col">
    <label for="lname">受洗日期</label>
    <input  type="date" required="required" id="受洗日期" name="受洗日期" placeholder="受洗日期..">
    </div>
    <div class="col">
    <label for="lname">入會日期</label>
    <input type="date" required="required" id="入會日期" name="入會日期" placeholder="入會日期..">
    </div>
    <div class="col">
    <label for="lname">參加小組日期</label>
    <input type="date" required="required" id="參加小組日期" name="lastname" placeholder="身分證字號..">
    </div>
</div>
<div class="row">
    <div class="col">
    <!-- <label for="lname">婚姻狀況</label> -->
    <input type="text" id="婚姻狀況" name="婚姻狀況" placeholder="婚姻狀況..">
    </div>
    <div class="col">
    <!-- <label for="lname">配偶姓名</label> -->
    <input type="text" id="配偶姓名" name="配偶姓名" placeholder="配偶姓名..">
    </div>
    <div class="col">
    <!-- <label for="lname">小孩數</label> -->
    <input type="text" id="小孩數" name="小孩數" placeholder="小孩數..">
    </div>
</div>
<div class="row">
      <div class="col">
    <!-- <label for="lname">父親姓名</label> -->
    <input type="text" id="父親姓名" name="父親姓名" placeholder="父親姓名..">
    </div>
    <div class="col">
    <!-- <label for="lname">母親姓名</label> -->
    <input type="text" id="母親姓名" name="母親姓名" placeholder="母親姓名..">
    </div>
</div>
<div class="row">
    <div class="col">
    <!-- <label for="lname">個人專長</label> -->
    <input type="text" id="個人專長" name="個人專長" placeholder="個人專長..">
    </div>
    <div class="col">
    <!-- <label for="lname">陪談者</label> -->
    <input type="text" id="陪談者" name="陪談者" placeholder="陪談者..">
    </div>
</div>


    <!-- <label for="subject">備註</label> -->
    <textarea id="備註" name="備註" placeholder="備註.." style="height:100px"></textarea>

    <div class="submit" style="text-align:center;">
        <input type="submit" value="提交資料" id="form_button" name="submit" style="text-align:center;font-size: 1.5rem;width:40%;" />
    </div>
  </form>
</div>
</div>

	<!-- 下搭表單的的JS -->
	<script type="text/javascript" src="script.js"></script>

    <!-- 上傳到資料庫 -->
    <script type="text/javascript">
        const scriptURL = 'https://script.google.com/macros/s/AKfycbzFUpyBgngAWKGh6IaEPs5JDf-61Vz-OB-qMEMO_CBbjH1HBiZQuj3mAKh-UFLeoPDmbw/exec';
        const form = document.forms['formdata'];
        const submitBtn = form.querySelector('input[type="submit"]');
      
        form.addEventListener('submit', e => {
          e.preventDefault();
      
          const confirmationMessage = '確定要提交表單嗎？';
          if (!confirm(confirmationMessage)) {
            alert('已取消上傳表單');
            return;
          }
      
          submitBtn.disabled = true; // disable submit button to prevent multiple submissions
      
          fetch(scriptURL, { method: 'POST', body: new FormData(form) })
            .then(response => {
              if (response.ok) {
                alert('上傳完成');
                form.reset(); // reset the form after successful submission
              } else {
                throw new Error('上傳失敗');
              }
            })
            .catch(error => {
              console.error('Error!', error.message);
              alert(`發生錯誤: ${error.message}`);
            })
            .finally(() => {
              submitBtn.disabled = false; // enable the submit button again
            });
        });
      </script>

</body>
</html>
